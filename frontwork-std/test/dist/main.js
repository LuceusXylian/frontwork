function X(a){let e=a.split("://");if(e.length<2)throw new Error("Invalid URL: "+a);let t=e[0]+":",r=e[1].split("?"),n=r[0].split("/"),o=n[0],l;if(n.length<2)l="/";else{l="";for(let s=1;s<n.length;s++)l+="/"+n[s]}let i,c;if(r.length>1){let s=r[1].split("#");i=s[0],c=s.length>1?s[1]:""}else i="",c="";return{protocol:t,host:o,path:l,query_string:i,fragment:c}}function C(a,e,t){let r={},n=a.split(e);for(let o=0;o<n.length;o++){let i=n[o].split(t);i[0]!==""&&(i.length===2?r[i[0]]=i[1]:r[i[0]]="")}return r}function I(a,e){for(let t=0;t<e.length;t++){let r=e[t];a.setAttribute(r.name,r.value)}}var y=class{observers=[];retriever=null;value=null;retriever_listeners=[];renew_is_running=!1;define_retriever(e){this.retriever=e}remove_retriever(){this.retriever=null}subscribe(e){this.value!==null&&e(this.value),this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(t=>t!==e)}add_retriever_listener(e){this.retriever_listeners.push(e)}remove_retriever_listener(e){this.retriever_listeners=this.retriever_listeners.filter(t=>t!==e)}set(e){this.value=e,this.observers.forEach(t=>t(e))}set_value(e){this.set({ok:!0,val:e})}set_null(){this.value=null}is_null(){return this.value===null}set_once(e){this.value===null&&this.set({ok:!0,val:e})}get(){return new Promise((e,t)=>{if(this.value===null)if(this.retriever===null||this.renew_is_running){let r=n=>{n.ok?e(n.val):t(n.err),this.unsubscribe(r)};this.subscribe(r)}else this.get_renew().then(r=>e(r)).catch(r=>t(r));else this.value.ok?e(this.value.val):t(this.value.err)})}get_renew(){return new Promise(async(e,t)=>{if(this.renew_is_running){let r=n=>{n.ok?e(n.val):t(n.err),this.unsubscribe(r)};this.subscribe(r)}else{let r=await this.renew();r.ok?e(r.val):t(r.err)}})}renew(){return new Promise(async(e,t)=>{if(this.retriever===null){t(new Error("For Observer.renew() the retriever must be defined"));return}this.renew_is_running=!0,this.retriever_listeners.forEach(r=>r());try{let r=await this.retriever();this.set(r),this.renew_is_running=!1,r.ok||u.reporter(2,"Observer","ERROR executing Observer.retriever()",null,r.err),e(r)}catch(r){this.renew_is_running=!1;let n={ok:!1,err:r instanceof Error?r:new Error(String(r))};t(n)}})}get count(){return this.observers.length}clear(){this.observers=[],this.value=null}};var u={is_client_side:!0,reporter_client_to_server:!0,verbose_logging:!1,reporter:function(a,e,t,r,n){u.reporter_client_to_server&&u.is_client_side&&fetch(location.protocol+"//"+location.host+"//dr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report_text:t})}),a===2?n===null?console.error(t):console.error(t,n):a===1?console.warn(t):a===0&&console.log(t)}},m=class{element;created_element;constructor(e,t){this.element=e,this.created_element=t}prepend_to(e){return this.created_element&&e.element.prepend(this.element),this}append_to(e){return this.created_element&&e.element.append(this.element),this}replace_text(e,t){this.element.innerText=this.element.innerText.split(e).join(t)}replace_html(e,t){this.element.innerHTML=this.element.innerHTML.split(e).join(t)}then(e){this.created_element&&e()}},F=class extends m{constructor(e,t,r,n){super(e.ensure_element("form",t,{action:r,method:n}).element,e.do_building),this.element.setAttribute("fw-form","1")}};var R=class{locales;selected_locale;constructor(e){if(e.length===0)throw new Error("I18n: No locales provided");this.locales=e,this.selected_locale=e[0]}set_locale(e){u.verbose_logging&&u.reporter(0,"I18n",'    Setting locale to "'+e+'"',null,null);let t=this.locales.find(r=>r.locale===e);return t===void 0?(u.reporter(2,"I18n","Locale '"+e+"' does not exist",null,null),!1):(this.selected_locale=t,!0)}get_translation(e){return this.selected_locale.get_translation(e)}get_translation_replace(e,t,r){return this.selected_locale.get_translation(e).split(t).join(r)}get_translation_replace_number(e,t,r){return r===1?this.selected_locale.get_translation(e+"_one"):this.selected_locale.get_translation(e).split(t).join(r.toString())}},v=class{locale;translations;constructor(e,t){this.locale=e,this.translations=t}get_translation(e){let t=this.translations[e];return t===void 0?(u.reporter(2,"I18n","    Missing translation for the locale '"+this.locale+`': ,"`+e+'": "translated_text"',null,null),""):t}},T=class{items;constructor(e){this.items=e}get(e){let t=this.items[e];return t===void 0?null:t}forEach(e){Object.entries(this.items).forEach(([t,r])=>{e(t,r)})}},D=class extends T{constructor(e){super(e)}},f=class extends T{constructor(e){super(e)}async from_request(e){let t=e.headers.get("content-type");if(t!==null&&(t=t.split(";")[0],e.body!==null)){if(t==="application/x-www-form-urlencoded"){let r=e.body.getReader();r!==null&&await r.read().then(n=>{if(n.value!==null){let o=new TextDecoder().decode(n.value);this.items=C(o,"&","=")}})}else if(t==="application/json"){let r=e.body.getReader();r!==null&&await r.read().then(n=>{if(n.value!==null){let o=new TextDecoder().decode(n.value);this.items=JSON.parse(o)}})}}return this}},P=class extends T{constructor(e){super(e)}};var b=class{headers;method;url;protocol;host;path;path_dirs;query_string;fragment;GET;POST;COOKIES;constructor(e,t,r,n){let o=X(t);this.headers=r,this.method=e,this.url=t,this.protocol=o.protocol,this.host=o.host,this.path=o.path,this.path_dirs=decodeURIComponent(o.path.replace(/\+/g,"%20")).split("/"),this.query_string=o.query_string,this.fragment=o.fragment,this.GET=new D(C(o.query_string,"&","=")),this.POST=n;let l=this.headers.get("cookie");this.COOKIES=new P(l===null?{}:C(l,"; ","="))}__request_text(e){let t=this.method+" "+this.path;this.query_string!==""&&(t+="?"+this.query_string),t+=" ["+e+"]";let r=Object.keys(this.POST.items);return r.length!==0&&(t+=`
    Scope POST: `,r.forEach(n=>{t+=`
        `+n+' = "'+this.POST.items[n]+'"'})),t}log(e,t){u.verbose_logging&&u.reporter(0,e,this.__request_text(e),t,null)}error(e,t,r){u.reporter(2,e,this.__request_text(e),t,r)}},p=class{status_code;mime_type="text/html";content;headers=[];cookies=[];constructor(e,t){this.status_code=e,this.content=t}set_mime_type(e){return this.mime_type=e,this}add_header(e,t){return this.headers.push([e,t]),this}get_header(e){for(let t of this.headers)if(t[0]===e)return t[1];return null}set_cookie(e){for(let t=0;t<this.cookies.length;t++)if(this.cookies[t].name===e.name)return this.cookies[t]=e,this;return this.cookies.push(e),this}into_response(){let e=new Response(this.content.toString(),{status:this.status_code});e.headers.set("content-type",this.mime_type);for(let t=0;t<this.headers.length;t++){let r=this.headers[t];e.headers.set(r[0],r[1])}for(let t=0;t<this.cookies.length;t++){let r=this.cookies[t];e.headers.append("set-cookie",r.to_string())}return e}},E=class{context;doctype;constructor(e){this.context=e,this.doctype="<!DOCTYPE html>",this.set_html_lang(e.i18n.selected_locale.locale)}head_append_tag(e,t){let r=document.createElement(e);if(t)for(let n in t)r.setAttribute(n,t[n]);return this.context.document_head.append(r),this}add_head_meta_data(e,t,r){this.context.document_head.appendChild(document.createElement("meta")).setAttribute("charset","UTF-8");let o=this.context.document_head.appendChild(document.createElement("meta"));o.setAttribute("http-equiv","X-UA-Compatible"),o.setAttribute("content","IE=edge");let l=this.context.document_head.appendChild(document.createElement("meta"));l.setAttribute("name","viewport"),l.setAttribute("content","width=device-width, initial-scale=1, maximum-scale=1");let i=this.context.document_head.appendChild(document.createElement("title"));i.innerHTML=e;let c=this.context.document_head.appendChild(document.createElement("meta"));c.setAttribute("name","description"),c.setAttribute("content",t);let s=this.context.document_head.appendChild(document.createElement("meta"));return s.setAttribute("name","robots"),s.setAttribute("content",r),this}add_head_meta_opengraph_website(e,t,r,n){let o=this.context.document_head.appendChild(document.createElement("meta"));o.setAttribute("property","og:type"),o.setAttribute("content","website");let l=this.context.document_head.appendChild(document.createElement("meta"));l.setAttribute("property","og:url"),l.setAttribute("content",r);let i=this.context.document_head.appendChild(document.createElement("meta"));i.setAttribute("property","og:title"),i.setAttribute("content",e);let c=this.context.document_head.appendChild(document.createElement("meta"));c.setAttribute("property","og:description"),c.setAttribute("content",t);let s=this.context.document_head.appendChild(document.createElement("meta"));return s.setAttribute("property","og:image"),s.setAttribute("content",n),this}set_html_lang(e){return this.context.document_html.setAttribute("lang",e),this}body_append(e){return this.context.document_body.append(e.element),e}html(){let e=this.context.document_head.appendChild(document.createElement("link"));e.setAttribute("id","fw-style"),e.setAttribute("rel","stylesheet"),e.setAttribute("href","/css/style.css"),e.setAttribute("type","text/css");let t=this.context.document_body.appendChild(document.createElement("script"));return t.setAttribute("id","fw-script"),t.setAttribute("src","/js/main.js"),t.setAttribute("type","text/javascript"),this.context.document_html}toString(){let e=this.html();return this.doctype+`
`+e.outerHTML}},L=class extends p{constructor(e,t){u.verbose_logging&&u.reporter(0,"REDIRECT","    ["+t+" REDIRECT]-> "+e,null,null),super(t,"redirecting..."),this.add_header("Location",e)}},z=0,h=class{id;path;component;constructor(e,t){this.path=e,this.component=t,this.id=z,z+=1}};var q={},A=class{platform;stage;client_ip;api_protocol_address;api_protocol_address_ssr;i18n;request;do_building;document_html;document_head;document_body;api_error_event;client;set_cookies=[];constructor(e,t,r,n,o,l,i,c,s,d){this.platform=e,this.stage=t,this.client_ip=r,this.api_protocol_address=n,this.api_protocol_address_ssr=o,this.api_error_event=l,this.i18n=i,this.request=c,this.do_building=s,this.client=d,this.document_html=document.createElement("html"),this.document_head=this.document_html.appendChild(document.createElement("head")),this.document_body=this.document_html.appendChild(document.createElement("body"))}server_observers={};get_observer(e){return u.is_client_side?(q[e]||(q[e]=new y),q[e]):(this.server_observers[e]||(this.server_observers[e]=new y),this.server_observers[e])}create_element(e,t){let r=document.createElement(e);if(t)for(let n in t)r.setAttribute(n,t[n]);return new m(r,!0)}create_text_element(e,t,r){let n=document.createElement(e);if(n.innerText=this.get_translation(t),r)for(let o in r)n.setAttribute(o,r[o]);return new m(n,!0)}ensure_element(e,t,r){let n=this.do_building?this.document_html.querySelector("#"+t):document.getElementById(t);if(n!==null)return new m(n,!1);let o=document.createElement(e);if(o.id=t,r)for(let l in r)o.setAttribute(l,r[l]);return new m(o,!0)}ensure_text_element(e,t,r){let n=this.do_building?this.document_html.querySelector("#"+t):document.getElementById(t);if(n!==null)return new m(n,!1);let o=document.createElement(e);if(o.id=t,o.innerText=this.get_translation(t),r)for(let l in r)o.setAttribute(l,r[l]);return new m(o,!0)}async api_request(e,t,r,n={}){let o=(u.is_client_side?this.api_protocol_address:this.api_protocol_address_ssr)+t,l=n;l.method=e,l.headers=n.headers?n.headers:new Headers;let i="",c=Object.entries(r);if(c.length>0){i+=c[0][0]+"="+c[0][1];for(let s=1;s<c.length;s++)i+="&"+c[s][0]+"="+c[s][1]}if(e==="GET"?i.length>0&&(o+="?"+i):(l.body=i,l.headers.set("Content-Type","application/x-www-form-urlencoded")),!u.is_client_side){let s="";this.request.COOKIES.forEach((d,_)=>{s+=d+"="+_+"; "}),l.headers.set("Cookie",s),l.headers.set("X-Forwarded-For",this.client_ip)}try{let s=await fetch(o,l);if(u.is_client_side||s.headers.getSetCookie().forEach(g=>this.set_cookies.push(g)),!s.ok){u.reporter(2,"api_request","ERROR executing api_request( "+e+" "+t+" )",this,null),console.error(s);try{let _=await s.json();return _.status=s.status,this.api_error_event(this,this.client,e,t,r,_),{ok:!1,err:_}}catch(_){u.reporter(2,"api_request","Could not parse ApiErrorResponse for api_request("+e+" "+t+")",this,_);let g={status:501,error_message:"API did not returned parsable JSON"};return this.api_error_event(this,this.client,e,t,r,g),{ok:!1,err:g}}}return{ok:!0,val:await s.json()}}catch(s){u.reporter(2,"api_request","ERROR executing api_request( "+e+" "+t+" )",this,s);let d={status:503,error_message:s};return this.api_error_event(this,this.client,e,t,r,d),{ok:!1,err:d}}}api_request_observer(e,t,r,n,o={}){let l=async()=>{let i=await this.api_request(t,r,n,o);return i.ok?{ok:!0,val:i.val}:{ok:!1,err:new Error(i.err.error_message)}};e.define_retriever(l),e.renew().catch(i=>{})}},S=class{platform;stage;port;api_protocol_address;api_protocol_address_ssr;domain_to_route_selector;middleware;i18n;api_error_event;constructor(e){this.platform=e.platform,this.stage=e.stage,this.port=e.port,this.api_protocol_address=e.api_protocol_address,this.api_protocol_address_ssr=e.api_protocol_address_ssr,this.domain_to_route_selector=e.domain_to_route_selector,this.middleware=e.middleware,this.i18n=e.i18n,this.api_error_event=e.api_error_event===void 0?()=>{}:e.api_error_event,this.stage===0&&(u.verbose_logging=!0)}async route_resolver(e){let t=await this.domain_to_route_selector(e);for(let r=0;r<t.length;r++){let n=t[r],o=n.path.split("/");if(e.request.path_dirs.length===o.length){for(let l=0;l<o.length;l++)if(e.request.path_dirs.length===o.length){let i=!0;for(let c=0;c<o.length;c++){let s=o[c];if(s!=="*"&&s!==e.request.path_dirs[c]){i=!1;break}}if(i)return u.verbose_logging&&e.request.log("ROUTE #"+n.id+" ("+n.path+")",e),n}}}return null}async route_execute_build(e,t){if(t)try{let r=new t.component(e);return{response:await r.build(e),component:r}}catch(r){return e.request.error("ROUTE #"+t.id+" ("+t.path+")",e,r),{response:await this.middleware.error_handler_component.build(e),component:this.middleware.error_handler_component}}u.verbose_logging&&e.request.log("NOT_FOUND",e);try{let r=new this.middleware.not_found_handler(e);return{response:await r.build(e),component:r}}catch(r){return e.request.error("NOT_FOUND",e,r),{response:await this.middleware.error_handler_component.build(e),component:this.middleware.error_handler_component}}}},M=class{error_handler;error_handler_component;not_found_handler;before_route;redirect_lonely_slash;constructor(e){this.error_handler=e.error_handler,this.error_handler_component={async build(t){return t.document_head.innerHTML="",t.document_body.innerHTML="",e.error_handler(t)},dom_ready(){},on_destroy(){}},this.not_found_handler=e.not_found_handler,this.before_route=e.before_route,this.redirect_lonely_slash=e&&e.redirect_lonely_slash?e.redirect_lonely_slash:!0}};var O=class extends S{build_on_page_load;client_observers={};page_change_ready=!0;page_change_previous_abort_controller=null;is_page_change_ready(){return this.page_change_ready}previous_component=null;previous_context=null;constructor(e){if(super(e),typeof e.build_on_page_load=="boolean"?this.build_on_page_load=e.build_on_page_load:this.build_on_page_load=!1,document.addEventListener("DOMContentLoaded",()=>{let t=new b("GET",location.toString(),new Headers,new f({}));this.page_change(t,this.build_on_page_load,!1)}),document.addEventListener("click",async t=>{let r=t.target;if(r.tagName==="A"&&(r.target===""||r.target==="_self")){let n=new URL(r.href);if(n.hostname!==""&&n.hostname!==window.location.hostname)return;this.page_change_ready?await this.page_change_to(r.href,!1)&&t.preventDefault():t.preventDefault()}},!1),document.addEventListener("submit",async t=>{let r=t.target;if(r.tagName==="FORM"&&r.getAttribute("fw-form")!==null)if(t.preventDefault(),r.ariaDisabled==="true")console.log("fw-form is ariaDisabled. Because it already has been submitted.",r);else{r.ariaDisabled="true";let n=t.submitter;n=n&&n.name?n:null;let o=await this.page_change_form(r,n);console.log("page_change_form result",o),r.ariaDisabled="false"}}),addEventListener("popstate",t=>{if(this.page_change_ready){let r=t.state;if(r&&r.url){let n=new b("GET",r.url,new Headers,new f({}));this.page_change(n,!0,!0)}}else history.pushState(null,"",window.location.pathname)}),this.stage===0){console.info("hot-reloading is enabled; Make sure this is the development environment");let t=0,r=()=>{let n=new WebSocket("ws://"+location.host+"//ws");n.onopen=function(){n.send("REQUEST::SERVICE_STARTED"),t===2?location.reload():t=1},n.onclose=function(){t=2,setTimeout(r,1e3)},n.onerror=function(){n.close()}};r()}}async page_change(e,t,r){if(this.page_change_ready||r){this.page_change_previous_abort_controller!==null&&this.page_change_previous_abort_controller.abort();let n=new AbortController;this.page_change_previous_abort_controller=n,this.previous_component!==null&&this.previous_context!==null&&await this.previous_component.on_destroy(this.previous_context,this);let o=new A(this.platform,this.stage,"127.0.0.1",this.api_protocol_address,this.api_protocol_address_ssr,this.api_error_event,this.i18n,e,t,this);this.previous_context=o;let l=await this.route_resolver(o);try{this.middleware.before_route.build(o),this.middleware.before_route.dom_ready(o,this)}catch(i){o.request.error("before_route",o,i)}if(t){let i=await this.route_execute_build(o,l);if(n.signal.aborted)return this.page_change_ready=!0,null;for(let s=0;s<i.response.cookies.length;s++){let d=i.response.cookies[s];d.http_only===!1&&(document.cookie=d.toString())}if(i.response.status_code===301||i.response.status_code===302){let s=i.response.get_header("Location");return s===null?(u.reporter(2,"REDIRECT","Tried to redirect: Status Code is 301, but Location header is null",o,null),this.page_change_ready=!0,null):(u.verbose_logging&&u.reporter(0,"REDIRECT","Redirect to: "+s,o,null),this.page_change_to(s,!0),this.page_change_ready=!0,{method:e.method,url:o.request.url,is_redirect:!0,status_code:i.response.status_code})}let c=i.response.content;if(typeof c.context.document_html<"u"){c.html(),I(document.children[0],c.context.document_html.attributes),I(document.head,c.context.document_head.attributes),document.head.innerHTML=c.context.document_head.innerHTML;let s=document.body.parentElement;if(document.body!==null&&document.body.remove(),s!==null){for(let d=0;d<o.document_body.children.length;d++){let _=o.document_body.children[d];_.tagName==="SCRIPT"&&_.remove()}s.append(o.document_body)}return i.component.dom_ready(o,this),this.previous_component=i.component,this.page_change_ready=!0,{method:e.method,url:e.url,is_redirect:!1,status_code:i.response.status_code}}}else if(l!==null){let i=new l.component(o);i.dom_ready(o,this),this.previous_component=i}else{let i=new this.middleware.not_found_handler(o);i.dom_ready(o,this),this.previous_component=i}this.page_change_ready=!0}return null}async page_change_to(e,t){u.verbose_logging&&u.reporter(0,"PageChange","    page_change_to: "+e,null,null);let r,n=e.indexOf("//");n===0||n===5||n===6?r=e:r=location.protocol+"//"+location.host+e;let o=new b("GET",r,new Headers,new f({})),l=await this.page_change(o,!0,t===!0);return l!==null?(l.is_redirect||history.pushState(l,document.title,r),!0):!1}async page_change_form(e,t){this.page_change_ready=!1,u.verbose_logging&&u.reporter(0,"PageChange","page_change_form",null,null);let r=e.getAttribute("method");r===null&&(r="POST");let n=r==="GET";t&&(t.disabled=!0);let o,l=e.getAttribute("action");l===""?this.previous_context?n?o=this.previous_context.request.protocol+"//"+this.previous_context.request.host+this.previous_context.request.path:o=this.previous_context.request.url:(o=location.protocol+"//"+location.host+window.location.pathname.toString(),n&&location.search!==""&&(o+=location.search)):o=location.protocol+"//"+location.host+l,this.middleware.redirect_lonely_slash&&o.substring(o.length-1)==="/"&&(o=o.substring(0,o.length-1));let i=new FormData(e),c=new f({});if(n){let _=!0;i.forEach((g,ee)=>{_?(_=!1,o+="?"):o+="&",o+=ee+"="+encodeURIComponent(g.toString())}),t!==null&&(o+=(_?"?":"&")+t.name+"="+t.value)}else i.forEach((_,g)=>c.items[g]=_.toString()),t!==null&&(c.items[t.name]=t.value);let s=new b(r,o,new Headers,c),d=await this.page_change(s,!0,!0);return console.log("page_change_form result inner",d),d!==null?(d.is_redirect||history.pushState(d,document.title,o),!0):(t&&(t.disabled=!0),!1)}};var Q={title1:"Frontwork Test Page",text1:"This is a test page for the Frontwork framework.",title2:"Test Form","test-page2":"Test Page 2",another_title1:"Hello from 127.0.0.1",another_text1:"Yes you can have different domains :)","a-home":"Home","a-test2":"Test2","a-test3":"Test3","a-german":"German","a-crash":"Crash",event_button_tester:"Event Button Tester",formtest_title_fail:"This form test was sent to the Deno server!",formtest_title_ok:"This form test was not sent to the Deno server :)",submit_button:"Submit"};var V={title1:"Frontwork Test Seite",text1:"Dies ist eine deutsche Test Seite f\xFCr das Frontwork framework.",title2:"Test Formular","a-home":"Startseite","a-test2":"Testseite2","a-test3":"Testseite3","a-german":"Deutsch","a-crash":"Absturz",event_button_tester:"Ereignistastentester",formtest_title_fail:"Dieser Formtest wurde an den Deno Server gesendet!",formtest_title_ok:"Dieser Formtest wurde nicht an den Deno Server gesendet :)",submit_button:"Senden"};var Z=new R([new v("en",Q),new v("de",V)]);var w=class extends E{main;constructor(e){super(e);let t=this.body_append(e.create_element("header"));e.ensure_text_element("a","a-home",{href:"/"}).append_to(t),e.ensure_text_element("a","a-test2",{href:"/test2"}).append_to(t),e.ensure_text_element("a","a-test3",{href:"/test3"}).append_to(t),e.ensure_text_element("a","a-german",{href:"/german"}).append_to(t),e.ensure_text_element("a","a-crash",{href:"/crash"}).append_to(t),this.main=this.body_append(e.create_element("main"))}},N=class{async build(e){let t=new E(e),r=t.body_append(e.create_element("main"));return e.ensure_text_element("h1","another_title1").append_to(r),e.ensure_text_element("p","another_text1").append_to(r),new p(200,t)}async dom_ready(){}async on_destroy(){}},H=class{button_event;constructor(e){this.button_event=e.ensure_text_element("button","event_button_tester",{type:"button"})}async build(e){let t=await e.get_observer("user").get();console.log("The User is",t);let r=new w(e),n=e.ensure_text_element("h1","title1").append_to(r.main),o=e.ensure_text_element("p","text1").append_to(r.main);this.button_event.append_to(r.main);let l=e.create_element("section").append_to(r.main);if(e.ensure_text_element("h2","title2").append_to(l),e.request.GET.get("action")!==null){e.ensure_text_element("h3","formtest_title_"+(u.is_client_side?"ok":"fail")).append_to(l);for(let s=0;s<3;s++){let d=e.create_element("div").append_to(l);d.element.innerHTML="text"+s+": "+e.request.GET.get("text"+s)}}let c=new F(e,"test_form","","GET").append_to(l);for(let s=0;s<3;s++)e.ensure_element("input","input"+s,{type:"text",name:"text"+s,value:"asdsad"+s}).append_to(c);return e.ensure_text_element("button","submit_button",{type:"submit",name:"action",value:"sent"}).append_to(c),new p(200,r.add_head_meta_data(n.element.innerText,o.element.innerText,"noindex,nofollow"))}async dom_ready(e,t){try{let r=0;this.button_event.element.addEventListener("click",()=>{r++,this.button_event.element.innerHTML="Changed "+r+" times"})}catch(r){console.error(r)}}async on_destroy(){}},B=class extends H{constructor(e){e.i18n.set_locale("de"),super(e)}async build(e){return await super.build(e)}async dom_ready(e,t){super.dom_ready(e,t)}},K=class{async build(e){let t=new w(e),r=e.ensure_text_element("h1","test-page2").append_to(t.main),n=e.ensure_element("p","description").append_to(t.main);return n.element.innerHTML="This is a test page <b>2</b> for the Frontwork framework. I will redirect you with js to the home page in 1 second.",u.reporter(1,"TEST","Warn counter test for Testworker",e,null),new p(200,t.add_head_meta_data(r.element.innerText,n.element.innerText,"noindex,nofollow"))}async dom_ready(e,t){setTimeout(()=>{t.page_change_to("/",!1)},1e3)}async on_destroy(){console.log("on_destroy test")}},W=class{async build(){return new L("/",301)}async dom_ready(){}async on_destroy(){}},U=class{async build(e){let t=new w(e);return new p(200,t.add_head_meta_data("element_test","element_test","noindex,nofollow"))}async dom_ready(){}async on_destroy(){}},x=class{async build(e){let t="Hello this is indeed first come, first served basis";return new p(200,t)}async dom_ready(e){}async on_destroy(){}},k=class{async build(e){let t="Hello "+e.request.path_dirs[2];return new p(200,t)}async dom_ready(e){}async on_destroy(e){}},G=class{async build(e){return e.request.path_dirs[2]==="first-come-first-served"?new x().build(e):new k().build(e)}async dom_ready(e){e.request.path_dirs[2]==="first-come-first-served"&&new x().dom_ready(e),new k().dom_ready(e)}async on_destroy(){}},j=class{async build(){throw new Error("Crash Test")}async dom_ready(){}async on_destroy(){}},J=class{async build(e){let t=new w(e),r=e.document_body.appendChild(document.createElement("h1"));return r.innerText="ERROR 404 - Not found",new p(404,t.add_head_meta_data(r.innerText,r.innerText,"noindex,nofollow"))}async dom_ready(){}async on_destroy(){}},oe=[new h("/",H),new h("/test2",K),new h("/test3",W),new h("/german",B),new h("/crash",j),new h("/element_test",U),new h("/hello/first-come-first-served",x),new h("/hello/*",k),new h("/hi/*",G)],se=[new h("/",N)];var ie=new M({before_route:{build:async a=>{a.i18n.set_locale("en");let e=a.get_observer("user");e.is_null()&&a.api_request_observer(e,"POST","/api/v1/account/user",{}),a.api_request("POST","/api/v1/account/create",{user_name:"a"})},dom_ready:async()=>{console.log("ASDAAAAAAAAA")}},error_handler:async a=>{let e=new w(a),t=a.document_body.appendChild(document.createElement("h1"));return t.innerText="ERROR 500 - Internal server error",new p(500,e.add_head_meta_data(t.innerText,t.innerText,"noindex,nofollow"))},not_found_handler:J}),$={platform:0,stage:0,port:8080,api_protocol_address:"",api_protocol_address_ssr:"http://localhost:40201",domain_to_route_selector:async a=>a.request.host.split(":")[0]==="127.0.0.1"?se:oe,middleware:ie,i18n:Z,build_on_page_load:!1,api_error_event:(a,e,t,r,n,o)=>{a.request.path!=="/"&&e!==null&&o.status===401&&e.page_change_to("/",!0)}};new O($);
